# 接口

## 1获取试卷exam/getPaper

请求POST

## 2获取试卷exam/[id]

id应该是一个数字或字符串？

请求GET

这个接口是为了保证使用url就能方便地利用id标记试卷，避免重复发送相同请求。详见[扩展功能.md](扩展功能.md)。

## 3直接打开试卷/exam/[id]

请求GET

返回一个空白页面。

等到Vue框架加载完毕后，前端会用api/exam/的两种接口再次获取内容。

## 4下载文件question/getFile

出题目时可以上传文件，渲染题目时提供下载方法

请求POST

```json
{
    token,
    question:question id,
    id:file id
}
```

## 5获取时间time/getTime

本地时间不靠谱，要以服务器时间为准。

加载时获取一次时间，然后计算出本地时间差。

请求GET

响应：一个整数

```
timestamp
```

## 6加载备份exam/loadBackup

由worker负责，后端不需要响应，直接返回404即可

## 7保存备份exam/saveBackup

后端不需要响应

## 8提交答案exam/submit

### 自动提交

当考试结束时，在一分钟内，如果存在答题记录，而且之前没有提交过，则由系统代为提交，且时间设置为考试结束时间

### 手动补交

当考试结束后，提交功能不可用，补交功能可用。如果考试允许补交，则仍然可通过此接口提交答案，但会附带`type=overdue`，以与正常提交行为区分。

## 9运行代码code/run

## <del>10语法检查code/lsp（扩展功能）</del>

11

# 功能

## 1渲染试卷

1. 初始化边栏
2. 按照题目顺序依次渲染试题
3. 在边栏里呈现题目数量与作答情况
4. 从

## 2备份回答

1. 每隔5分钟，每当焦点移动到另一道题，每当运行代码，每当提交答案时，每当关闭页面，就备份回答
2. 向worker发送当前回答的内容、试卷id、当前时间、考试结束时间与用户id。如果当前时间小于考试时间，有效期到考试结束为止
3. 当用户注销时，向worker请求删除用户备份